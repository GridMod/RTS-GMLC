# generator outages
list("generator_outages.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators')),
# units not yet in operation in 2014 -- MAYBE later, add 2014 scenario?
list("units_turned_off.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
# hydro limits
list("hydro_lims_monthly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'month',
scenario.name = 'Hydro: monthly energy limits',
period.id = '3')),
list("hydro_lims_weekly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'week',
scenario.name = 'Hydro: weekly energy limits')),
list("hydro_lims_daily_min.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'day',
scenario.name = 'Hydro: daily min limits'))
)
# add generator properties that have to be mapped by fuel.
# list element structure: list, with the first element the character vector
# name of the input file, the second the arguments for merge_property_by_fuel
# (name of property columns and optional tag to multiply by max capacity), and
# the third the arguments for add_to_properties_sheet (see above)
generator.property.by.fuel.list <- list(
list("map_min_gen_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Stable Level'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
list("map_ramps_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Max Ramp Up', 'Max Ramp Down'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators')),
list("min_up_and_down_time_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Up Time', 'Min Down Time')),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators'))
)
# generic interface names list.
# list of vectors with named elements pointing to files with interface names,
# properties, memberships, and flow coefficients.
# scenario-ing is done in script c3
interfaces.files.list <- list(
# zonal interfaces
c(names = 'interface_names_2014_zonal.csv',
properties = 'interface_properties_2014_zonal.csv',
memberships = 'interface_memberships_2014_zonal.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_zonal.csv'),
# regional interfaces
c(names = 'interface_names_2014_regional.csv',
properties = 'interface_properties_2014_regional.csv',
memberships = 'interface_memberships_2014_regional.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_regional.csv')
)
# define as many files as needed for generic imports
# currently, this defines horizons, ST and MT schedules, reports, and models
generic.import.files <- c(
"import_STSchedule_MTSchedule_Performance_Transmission_Production.csv",
"import_diagnostic.csv",
"import_report_default.csv",
"import_report_detailed.csv",                 #currently in all models
#PASA
"PASA.csv"
)
# compact generic files format (different file for each object type)
compact.generic.import.files <- list(
c('import_models.csv', 'model'),
c('import_horizons.csv', 'horizon')
)
# ---- other input parameters ----
units.to.delete.file <- "units_retired_by_2014.csv"
start.cost.file <- "start_cost_by_fuel.csv"
enforced.interstate.lines.file <- "lines_to_enforce.csv"
isolated.nodes.to.remove.file <- "isolated_nodes_to_remove.csv"
wheeling.charge.cases.files <- list(
`Add $2 Wheeling Charge` = "wheeling_charges_2.csv",
`Add $3/4 Mixed Wheeling Charge` = "wheeling_charges_34mix.csv",
`Add $5 Wheeling Charge` = "wheeling_charges_5.csv")
# ---- define output parameters ----
output.wb.name <- "AE_3_15_streamlining_16_condense_obj_to_prop.xlsx"
#------------------------------------------------------------------------------|
# run all scripts ----
#------------------------------------------------------------------------------|
runAllFiles()
object.property.list
ls()
dir()
dir('../InputFiles')
dir('../InputFiles/*.csv')
dir('../InputFiles/')
dir('../InputFiles/',pattern = '.*.csv')
dir('../InputFiles/',pattern = '.*_object_properties.csv')
dir('../InputFiles/',pattern = '.*_object_properties.csv')
seq_along(object.property.list)
elem
cur.table <- fread(file.path('../InputFiles', object.property.list[[elem]][1]))
object.property.list[[elem]][1]
file.path('../InputFiles', object.property.list[[elem]][1])
exists(file.path('../InputFiles', object.property.list[[elem]][1]))
exists(file.path('../InputFiles', object.property.list[[elem]][1]))
file.exists(file.path('../InputFiles', object.property.list[[elem]][1]))
#install.packages("pacman")
pacman::p_load(cowplot, plyr, dplyr, ggplot2, grid, gridExtra, gtools,
knitr, lubridate, reshape2, data.table, RSQLite, stringr)
pacman::p_load(openxlsx)
# had to follow instructions here: https://github.com/awalker89/openxlsx,
# including installing Rtools from here:
# https://cran.r-project.org/bin/windows/Rtools/
# and making sure PATH variable was edited appropriately
# (check the "edit path" box during installation)
source("SourceScripts/functions.R")
#------------------------------------------------------------------------------|
# function definition ----
#------------------------------------------------------------------------------|
runAllFiles <- function () {
print("importing PSSE files...")
source("SourceScripts/a_import_raw.R")
print("creating tables...")
source("SourceScripts/b_create_sheet_tables.R")
print("populating and cleaning tables...")
source("SourceScripts/c1_populate_sheet_tables_with_raw_tables.R")
source("SourceScripts/c2_more_data_population.R")
source("SourceScripts/c3_create_scenarios_and_models.R")
source("SourceScripts/d_data_cleanup.R")
print("exporting tables...")
source("SourceScripts/e_export_to_excel.R")
}
#------------------------------------------------------------------------------|
# input file parameters ----
#------------------------------------------------------------------------------|
# For information about the contents and required format of these input files,
# see "Required Input Files" section in the readme.
# All files in input parameters and generic imports must be in "InputFiles"
# directory. Exported Excel workbook will be saved in "OutputFiles" directory.
# ---- required/generic inputs ----
# PSSE file
raw.file.path <- args[1]
# remap nodes' regions and zones? files are required if rename.regions or
# rename.zones are set to TRUE
map.newregion.file <- args[2]
rename.regions = ifelse(map.newregion.file=='',F,T)
map.newzone.file <- args[3]
rename.zones = ifelse(map.newzone.file=='',F,T)
# add generators to fuel
map.gen.to.fuel.file <- args[4]
# point each region to a load file
map.region.to.load.RE.file <- args[5]
# add new generators
RE.gen.file <- args[6]
add.RE.gens = ifelse(RE.gen.file=='',F,T)
# add properties to objects.
# files should be of the form: one column with names of all affected objects,
# all other columns named a string of the exact name of the plexos property to
# be added.
# List elemtn structure: list where first element is name of input file and
# second is a named list of arguments of add_to_properties_sheet. Required args
# are names.col (name of column holding object names), object.class, and
# collection.name
object.property.list <- list(
# generator VOM charges
list("map_generators_to_vom_charges.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators')),
# generator outages
list("generator_outages.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators')),
# units not yet in operation in 2014 -- MAYBE later, add 2014 scenario?
list("units_turned_off.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
# hydro limits
list("hydro_lims_monthly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'month',
scenario.name = 'Hydro: monthly energy limits',
period.id = '3')),
list("hydro_lims_weekly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'week',
scenario.name = 'Hydro: weekly energy limits')),
list("hydro_lims_daily_min.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'day',
scenario.name = 'Hydro: daily min limits'))
)
# add generator properties that have to be mapped by fuel.
# list element structure: list, with the first element the character vector
# name of the input file, the second the arguments for merge_property_by_fuel
# (name of property columns and optional tag to multiply by max capacity), and
# the third the arguments for add_to_properties_sheet (see above)
generator.property.by.fuel.list <- list(
list("map_min_gen_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Stable Level'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
list("map_ramps_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Max Ramp Up', 'Max Ramp Down'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators')),
list("min_up_and_down_time_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Up Time', 'Min Down Time')),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators'))
)
# generic interface names list.
# list of vectors with named elements pointing to files with interface names,
# properties, memberships, and flow coefficients.
# scenario-ing is done in script c3
interfaces.files.list <- list(
# zonal interfaces
c(names = 'interface_names_2014_zonal.csv',
properties = 'interface_properties_2014_zonal.csv',
memberships = 'interface_memberships_2014_zonal.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_zonal.csv'),
# regional interfaces
c(names = 'interface_names_2014_regional.csv',
properties = 'interface_properties_2014_regional.csv',
memberships = 'interface_memberships_2014_regional.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_regional.csv')
)
# define as many files as needed for generic imports
# currently, this defines horizons, ST and MT schedules, reports, and models
generic.import.files <- c(
"import_STSchedule_MTSchedule_Performance_Transmission_Production.csv",
"import_diagnostic.csv",
"import_report_default.csv",
"import_report_detailed.csv",                 #currently in all models
#PASA
"PASA.csv"
)
# compact generic files format (different file for each object type)
compact.generic.import.files <- list(
c('import_models.csv', 'model'),
c('import_horizons.csv', 'horizon')
)
# ---- other input parameters ----
units.to.delete.file <- "units_retired_by_2014.csv"
start.cost.file <- "start_cost_by_fuel.csv"
enforced.interstate.lines.file <- "lines_to_enforce.csv"
isolated.nodes.to.remove.file <- "isolated_nodes_to_remove.csv"
wheeling.charge.cases.files <- list(
`Add $2 Wheeling Charge` = "wheeling_charges_2.csv",
`Add $3/4 Mixed Wheeling Charge` = "wheeling_charges_34mix.csv",
`Add $5 Wheeling Charge` = "wheeling_charges_5.csv")
# ---- define output parameters ----
output.wb.name <- "AE_3_15_streamlining_16_condense_obj_to_prop.xlsx"
#------------------------------------------------------------------------------|
# run all scripts ----
#------------------------------------------------------------------------------|
runAllFiles()
sprintf("... %s does not exist ... skipping", object.property.list[[elem]][1])
elem
?message
#install.packages("pacman")
pacman::p_load(cowplot, plyr, dplyr, ggplot2, grid, gridExtra, gtools,
knitr, lubridate, reshape2, data.table, RSQLite, stringr)
pacman::p_load(openxlsx)
# had to follow instructions here: https://github.com/awalker89/openxlsx,
# including installing Rtools from here:
# https://cran.r-project.org/bin/windows/Rtools/
# and making sure PATH variable was edited appropriately
# (check the "edit path" box during installation)
source("SourceScripts/functions.R")
#------------------------------------------------------------------------------|
# function definition ----
#------------------------------------------------------------------------------|
runAllFiles <- function () {
print("importing PSSE files...")
source("SourceScripts/a_import_raw.R")
print("creating tables...")
source("SourceScripts/b_create_sheet_tables.R")
print("populating and cleaning tables...")
source("SourceScripts/c1_populate_sheet_tables_with_raw_tables.R")
source("SourceScripts/c2_more_data_population.R")
source("SourceScripts/c3_create_scenarios_and_models.R")
source("SourceScripts/d_data_cleanup.R")
print("exporting tables...")
source("SourceScripts/e_export_to_excel.R")
}
#------------------------------------------------------------------------------|
# input file parameters ----
#------------------------------------------------------------------------------|
# For information about the contents and required format of these input files,
# see "Required Input Files" section in the readme.
# All files in input parameters and generic imports must be in "InputFiles"
# directory. Exported Excel workbook will be saved in "OutputFiles" directory.
# ---- required/generic inputs ----
# PSSE file
raw.file.path <- args[1]
# remap nodes' regions and zones? files are required if rename.regions or
# rename.zones are set to TRUE
map.newregion.file <- args[2]
rename.regions = ifelse(map.newregion.file=='',F,T)
map.newzone.file <- args[3]
rename.zones = ifelse(map.newzone.file=='',F,T)
# add generators to fuel
map.gen.to.fuel.file <- args[4]
# point each region to a load file
map.region.to.load.RE.file <- args[5]
# add new generators
RE.gen.file <- args[6]
add.RE.gens = ifelse(RE.gen.file=='',F,T)
# add properties to objects.
# files should be of the form: one column with names of all affected objects,
# all other columns named a string of the exact name of the plexos property to
# be added.
# List elemtn structure: list where first element is name of input file and
# second is a named list of arguments of add_to_properties_sheet. Required args
# are names.col (name of column holding object names), object.class, and
# collection.name
object.property.list <- list(
# generator VOM charges
list("map_generators_to_vom_charges.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators')),
# generator outages
list("generator_outages.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators')),
# units not yet in operation in 2014 -- MAYBE later, add 2014 scenario?
list("units_turned_off.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
# hydro limits
list("hydro_lims_monthly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'month',
scenario.name = 'Hydro: monthly energy limits',
period.id = '3')),
list("hydro_lims_weekly_GWh.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'week',
scenario.name = 'Hydro: weekly energy limits')),
list("hydro_lims_daily_min.csv",
list(names.col = 'Generator.Name',
object.class = 'Generator',
collection.name = 'Generators',
pattern.col = 'day',
scenario.name = 'Hydro: daily min limits'))
)
# add generator properties that have to be mapped by fuel.
# list element structure: list, with the first element the character vector
# name of the input file, the second the arguments for merge_property_by_fuel
# (name of property columns and optional tag to multiply by max capacity), and
# the third the arguments for add_to_properties_sheet (see above)
generator.property.by.fuel.list <- list(
list("map_min_gen_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Stable Level'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators',
overwrite = TRUE)),
list("map_ramps_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Max Ramp Up', 'Max Ramp Down'),
mult.by.max.cap = TRUE),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators')),
list("min_up_and_down_time_by_fuel.csv",
fuel.map.args = list(prop.cols = c('Min Up Time', 'Min Down Time')),
add.to.prop.args = list(
object.class = 'Generator',
collection.name = 'Generators'))
)
# generic interface names list.
# list of vectors with named elements pointing to files with interface names,
# properties, memberships, and flow coefficients.
# scenario-ing is done in script c3
interfaces.files.list <- list(
# zonal interfaces
c(names = 'interface_names_2014_zonal.csv',
properties = 'interface_properties_2014_zonal.csv',
memberships = 'interface_memberships_2014_zonal.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_zonal.csv'),
# regional interfaces
c(names = 'interface_names_2014_regional.csv',
properties = 'interface_properties_2014_regional.csv',
memberships = 'interface_memberships_2014_regional.csv',
flowcoefs = 'interface_line_flow_coefficients_2014_regional.csv')
)
# define as many files as needed for generic imports
# currently, this defines horizons, ST and MT schedules, reports, and models
generic.import.files <- c(
"import_STSchedule_MTSchedule_Performance_Transmission_Production.csv",
"import_diagnostic.csv",
"import_report_default.csv",
"import_report_detailed.csv",                 #currently in all models
#PASA
"PASA.csv"
)
# compact generic files format (different file for each object type)
compact.generic.import.files <- list(
c('import_models.csv', 'model'),
c('import_horizons.csv', 'horizon')
)
# ---- other input parameters ----
units.to.delete.file <- "units_retired_by_2014.csv"
start.cost.file <- "start_cost_by_fuel.csv"
enforced.interstate.lines.file <- "lines_to_enforce.csv"
isolated.nodes.to.remove.file <- "isolated_nodes_to_remove.csv"
wheeling.charge.cases.files <- list(
`Add $2 Wheeling Charge` = "wheeling_charges_2.csv",
`Add $3/4 Mixed Wheeling Charge` = "wheeling_charges_34mix.csv",
`Add $5 Wheeling Charge` = "wheeling_charges_5.csv")
# ---- define output parameters ----
output.wb.name <- "AE_3_15_streamlining_16_condense_obj_to_prop.xlsx"
#------------------------------------------------------------------------------|
# run all scripts ----
#------------------------------------------------------------------------------|
runAllFiles()
install.packages('mailR')
library(mailR)
send.mail(from = "plexosusers@gmail.com",
to = c("claytonpbarrows@gmail.com"),
subject = "Subject of the email",
body = "Body of the email",
smtp = list(host.name = "smtp.gmail.com", port = 25, user.name = "plexosusers"
, passwd = "nrelplexosusers", ssl = TRUE),
authenticate = TRUE,
send = TRUE)
send.mail(from = "plexosusers@gmail.com",
to = c("claytonpbarrows@gmail.com"),
subject = "Subject of the email",
body = "Body of the email",
smtp = list(host.name = "smtp.gmail.com", port = 465, user.name = "plexosusers"
, passwd = "nrelplexosusers", ssl = TRUE),
authenticate = TRUE,
send = TRUE)
send.mail(from = "plexosusers@gmail.com",
to = c("claytonpbarrows@gmail.com"),
subject = "Subject of the email",
body = "Body of the email",
smtp = list(host.name = "smtp.gmail.com", port = 465, user.name = "plexosusers"
, passwd = "nrelplexosusers", ssl = TRUE),
authenticate = TRUE,
send = TRUE)
getwd()
install.packages(c('repr', 'IRdisplay', 'crayon', 'pbdZMQ', 'devtools'))
devtools::install_github('IRkernel/IRkernel')
IRkernel::installspec()
sys
IRkernel::installspec(name = 'ir33', displayname = 'R 3.3')
load('Documents/aaaaa/test_nyiso.rda')
z
head(z)
names(z)
write.csv(head(z),'bid_parameters.csv',row.names = F)
pacman::p_load(rhdf%)
pacman::p_load(rhdf5)
setwd('Documents/repos/RTS-GMLC/')
setwd('Create_PLEXOS_database/')
source()
source('1-parse-matpower/create_other_inputs_rts2016.R')
source('1-parse-matpower/parse_matpower.R')
getwd()
source('create_other_inputs_rts2016.R')
sourcE('parse_matpower.R')
source('parse_matpower.R')
source('create_other_inputs_rts2016.R')
setwd('../2-create-excel/')
source('run_PSSE2PLEXOS.R')
setwd('../1-parse-matpower/')
source('parse_matpower.R')
source('create_other_inputs_rts2016.R')
setwd('../2-create-excel/')
source()
source('run_PSSE2PLEXOS.R')
